from telegram import InlineKeyboardButton, InlineKeyboardMarkup


async def show_tutorial_menu(target):
	text = (
		"๐ <b>ุขููุฒุด ุจุงุฒ</b>\n\n"
		"ุฏุฑ ุงู ุจุฎุด ูโุชูุงูุฏ ุขููุฒุด ุจุฎุดโูุง ูุฎุชูู ุจุงุฒ ุฑุง ุจุจูุฏ.\n"
		"ูุฑ ููู ุฏููุง ูุดุงุจู ููู ุงุตู ุงุณุช ู ุชูุถุญ ูโุฏูุฏ ฺู ฺฉุงุฑ ุงูุฌุงู ุฏูุฏ ู ูุชุฌู ุขู ฺุณุช."
	)
	keyboard = [
		[InlineKeyboardButton('๐ ูุถุนุช ฺฉุดูุฑ', callback_data='tut_country_status')],
		[InlineKeyboardButton('๐๏ธ ุงุณุชุฑุงุชฺ ู ูุธุงู', callback_data='tut_strategy')],
		[InlineKeyboardButton('๐ค ุฏูพููุงุณ', callback_data='tut_diplomacy')],
		[InlineKeyboardButton('๐ฑ ุชุฌุงุฑุช ู ุงูุชุตุงุฏ', callback_data='tut_trade')],
		[InlineKeyboardButton('โ๏ธ ูุถุนุช ุฌูุนุช', callback_data='tut_population')],
		[InlineKeyboardButton('๐ฐ๏ธ ูุถุง', callback_data='tut_space')],
		[InlineKeyboardButton('๐ง ููุงูุฑ', callback_data='tut_technology')],
		[InlineKeyboardButton('๐ ุจุงุฒฺฏุดุช', callback_data='back_to_main')],
	]
	# ูพุดุชุจุงู ุงุฒ ูุฑ ุฏู ุญุงูุช: CallbackQuery ู Message
	if hasattr(target, 'edit_message_text'):
		# ุงุญุชูุงูุงู CallbackQuery ุงุณุช
		await target.edit_message_text(text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode='HTML')
	elif hasattr(target, 'reply_text'):
		# Message ุงุณุช
		await target.reply_text(text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode='HTML')
	else:
		# ุญุงูุช ูุงุดูุงุฎุชู: ุชูุงุด ุจุฑุง ุฏุณุชุฑุณ ุจู chat
		try:
			chat_id = getattr(getattr(target, 'chat', None), 'id', None)
			if chat_id:
				from telegram import Bot
				import utils
				bot = Bot(token=utils.BOT_TOKEN)
				await bot.send_message(chat_id=chat_id, text=text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode='HTML')
		except Exception:
			pass


def _section(title: str, body_lines: list[str]) -> str:
	parts = [f"{title}", ""]
	parts.extend(body_lines)
	return "\n".join(parts)


def _result(lines: list[str]) -> str:
	return "\n".join(["\n๐ <b>ูุชุงุฌ ู ุงุซุฑุงุช:</b>"] + [f"โซ๏ธ {l}" for l in lines])


async def show_tutorial_section(query, key: str):
	sections = {
		'country_status': _section(
			'๐ <b>ุขููุฒุด ูุถุนุช ฺฉุดูุฑ</b>', [
			'ุงู ุตูุญู ูุซู ุฏุงุดุจูุฑุฏ ุงุณุช ู ุฎูุงุตู ุฒุฑ ุฑุง ูุดุงู ูโุฏูุฏ:',
			'โข ููุฌูุฏ ููุฏุ ุงูุชุตุงุฏ ฺฉูุ ููุงุจุน ุจู ุชูฺฉฺฉุ ุณุงุฎุชูุงูโูุง ุณุงุฎุชูโุดุฏูุ ููุจ/ููุน ุญฺฉููุช',
			'โข ุชุญูู ููุดููุฏ ูุฒุฑ ฺฉุดูุฑ ู ุฏฺฉูู ยซ๐บ๏ธ ููุดู ุฌูุงูยป',
			'',
			'ฺุทูุฑ ุงุณุชูุงุฏู ฺฉูุฏ:',
			'1) ฺฉูุจูุฏ ููุงุจุน ุฑุง ูพุฏุง ฺฉูุฏ  2) ุจุฑุง ุชุงููุ ุจู ยซุชุฌุงุฑุชยป ุง ยซุณุงุฎุชโูุณุงุฒ/ููุงูุฑยป ุจุฑูุฏ',
			'3) ุจุง ุชูุฌู ุจู ุชุญูู ูุฒุฑุ ุชุตููุงุช ุงูุชุตุงุฏ/ุฏุงุฎู ุจฺฏุฑุฏ',
		]
		) + _result([
			'ุชุตููโฺฏุฑ ุณุฑุน ุฏุฑุจุงุฑู ูุงูุงุช/ุชุฌุงุฑุช/ุชููุฏ',
			'ุงูููุชโุจูุฏ ุณุฑูุงูโฺฏุฐุงุฑ ุจุฑ ุงุณุงุณ ฺฉูุจูุฏูุง',
		]),
		'strategy': _section(
			'๐๏ธ <b>ุขููุฒุด ุงุณุชุฑุงุชฺ ู ูุธุงู</b>', [
			'ููููุง ููู ุฏุงุฎู ุงุณุชุฑุงุชฺ:',
			'โข ยซูุถุนุช ูุธุงู ฺฉุดูุฑยป: ููุงุด ุชุนุฏุงุฏ ูุฑููุง ุจู ุชูฺฉฺฉ ุฒูู/ููุง/ุฏุฑุง/ููุดฺฉ',
			'โข ยซุชููุฏ ุชุณูุญุงุชยป: ุชุนุฑู ู ุชุงุฏ ุณูุงุฑุด ุชููุฏ (ูุตุฑู ููุงุจุน ูุทุงุจู ุฏุณุชูุฑุงูุนูู ุชููุฏ)',
			'โข ยซุฑุชุจูโุจูุฏ ูุธุงู ุฌูุงูยป: ููุงุณู ูุฏุฑุช ฺฉุดูุฑูุง',
			'โข ยซุงุนูุงู/ูุฏุฑุช ุฌูฺฏโูุงยป (ุฏุฑ ุจุฎุดโูุง ุฏูพููุงุณ/ุฌูฺฏ): ูุดุงูุฏู/ุงูุฏุงู ุฏุฑฺฏุฑโูุง',
			'',
			'ฺุทูุฑ ุงุณุชูุงุฏู ฺฉูุฏ:',
			'1) ูุถุนุช ูุฑููุง ุฑุง ุจุจูุฏ  2) ฺฉุณุฑ ุฑุง ุจุง ยซุชููุฏ ุชุณูุญุงุชยป ุง ุฎุฑุฏ ุฌุจุฑุงู ฺฉูุฏ',
			'3) ูุจู ุงุฒ ูุฑ ุงูุฏุงู ุฌูฺฏุ ุจูุฏุฌู/ุชุฏุงุฑฺฉุงุช ู ุฑูุงุจุท ุฑุง ุจุณูุฌุฏ',
		]
		) + _result([
			'ุงูุฒุงุด ุจุงุฒุฏุงุฑูุฏฺฏ ู ุขูุงุฏฺฏ ุฌูฺฏ',
			'ูุตุฑู ููุงุจุน (ููุฒุงุช/ุงูุฑฺ/ูพูู) ู ูุงุฒ ุจู ุชูุงุฒู ุจุง ุงูุชุตุงุฏ',
		]),
		'diplomacy': _section(
			'๐ค <b>ุขููุฒุด ุฏูพููุงุณ</b>', [
			'ููููุง ููู ุฏุงุฎู ุฏูพููุงุณ:',
			'โข ยซุฑูุงุจุท ุจุง ฺฉุดูุฑูุงยป: ูุดุงูุฏู/ุจูุจูุฏ ุฑูุงุจุท ุฏูุฌุงูุจู',
			'โข ยซุณุงุฒูุงู ูููยป: ุตุฏูุฑ ูุทุนูุงููุ ุตูุฏูู ุฑุงุ ูุธุงุฑุช ู ุฏุงุฏฺฏุงูโูุง',
			'โข ยซุงุชุญุงุฏยป: ุณุงุฎุช ุงุชุญุงุฏ ุฌุฏุฏุ ุนุถูุชุ ฺุชุ ููุงูู ู ูุฏุฑุช ุงุนุถุง',
			'โข ยซุชุญุฑูยป: ุชูุธู ุชุญุฑูโูุง ุชุฌุงุฑ/ูุธุงู/ุฏูพููุงุชฺฉ (ุฏุฑ ุชุนุงูู ุจุง UN)',
			'โข ยซุจุงููยป ู ยซุนููุงุช ูุฎูยป: ุงุนูุงู ููุงุถุน ุง ุงูุฏุงู ูุฎู (ุฑุณฺฉ ู ุงุซุฑ)',
			'',
			'ฺุทูุฑ ุงุณุชูุงุฏู ฺฉูุฏ:',
			'1) ุฑูุงุจุท ููู ุฑุง ุชุฑูู ฺฉูุฏ  2) ุงุฒ ุงุชุญุงุฏ ุจุฑุง ููโุงูุฒุง ุฏูุงุน/ุชุฌุงุฑุช ุจูุฑู ุจุจุฑุฏ',
			'3) ุงุฒ ุธุฑูุช ุณุงุฒูุงู ููู ุจุฑุง ูุดุฑูุนุชโุจุฎุด ุง ููุงุฑ ุฑูุจ ุงุณุชูุงุฏู ฺฉูุฏ',
		]
		) + _result([
			'ุฏุณุชุฑุณ ุจูุชุฑ ุจู ุจุงุฒุงุฑ/ุงุชุญุงุฏูุง ู ฺฉุงูุด ุชูุดโูุง',
			'ุงุซุฑฺฏุฐุงุฑ ูุทุนูุงููโูุง/ุชุญุฑูโูุง ุจุฑ ุงูุชุตุงุฏ ู ุชูุงู ูุธุงู ฺฉุดูุฑูุง',
		]),
		'trade': _section(
			'๐ฑ <b>ุขููุฒุด ุชุฌุงุฑุช ู ุงูุชุตุงุฏ</b>', [
			'ููููุง ููู ุฏุงุฎู ุชุฌุงุฑุช:',
			'โข ยซุจุงุฒุงุฑ ุฌูุงูยป: ุฎุฑุฏ/ูุฑูุด ููุงุจุน ุจุง ููุชโูุง ูพูุง',
			'โข ยซุจุงุฒุงุฑ ุณูุงูยป: ุฌุฒุฆุงุช ุดุฑฺฉุชโูุงุ ุฎุฑุฏ/ูุฑูุด ุณููุ ฺฉู ูพูู ุณูุงู',
			'โข ยซุขฺฏู ูุฑูุด ุจุงุฒฺฉูยป (ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏู): ุงุฌุงุฏ/ูุฏุฑุช ุขฺฏูโูุง',
			'',
			'ฺุทูุฑ ุงุณุชูุงุฏู ฺฉูุฏ:',
			'1) ุจูุฏุฌู ููุฏ ุฑุง ุจุฑุฑุณ ฺฉูุฏ  2) ููุชโูุง ุฑุง ุจุณูุฌุฏ  3) ุณูุงุฑุดโูุง ุฑุง ูุฑุญููโุง ุซุจุช ฺฉูุฏ',
			'4) ุฏุฑ ุณูุงู: ยซฺฉู ุณูุงู ุฏุฑ ุฏุณุชุฑุณยป ู ุฑุณฺฉ ููุณุงู ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ',
		]
		) + _result([
			'ุชุงูู ฺฉุณุฑ ุง ููุฏุดููุฏฺฏ ุฏุงุฑุงโูุง',
			'ุณูุฏ/ุฒุงู ูุงุด ุงุฒ ููุณุงู ููุช ู ฺฉุงุฑูุฒุฏูุง ุงุญุชูุงู',
		]),
		'population': _section(
			'โ๏ธ <b>ุขููุฒุด ูุถุนุช ุฌูุนุช</b>', [
			'ููููุง ููู ุฏุงุฎู ุฌูุนุช:',
			'โข ยซูุทุงูุจู ูุงูุงุชยป: ุฏุฑุงูุช ุจูุฏุฌู ุจุง ฺฉููโุฏุงูู ูุดุฎุต',
			'โข ยซุณุฑฺฉูุจ ุดูุฑุดยป: +30% ุฑุถุงุช ู +30% ุงูููุงุจ (ุฑุณฺฉ ุฑุณุฏู ุงูููุงุจ ุจู 100%)',
			'โข ยซูุงุฒูุง ุบุฐุงยป: ฺฏูุฏู/ุจุฑูุฌ/ููู ุจุฑ ุงุณุงุณ ุฌูุนุช',
			'',
			'ฺุทูุฑ ุงุณุชูุงุฏู ฺฉูุฏ:',
			'1) ุงุจุชุฏุง ูุงุฒูุง ุบุฐุง ุฑุง ุชุงูู ฺฉูุฏ ุชุง ุฑุถุงุช ุงูุช ูฺฉูุฏ',
			'2) ูุงูุงุช ุฑุง ุฏุฑ ุฒูุงู ููุงุณุจ ุจฺฏุฑุฏ  3) ุณุฑฺฉูุจ ุดูุฑุด ููุท ุฏุฑ ุจุญุฑุงู ู ุจุง ุขฺฏุงู ุงุฒ ุฑุณฺฉ',
		]
		) + _result([
			'ูพุงุฏุงุฑ ุฏุงุฎู ุจุง ุชุบุฐู ู ูุฏุฑุช ุฑุถุงุช',
			'ุฏุฑ ุตูุฑุช 100% ุงูููุงุจ: ุณููุท ฺฉุดูุฑุ ุงูุชุฎุงุจ ูุฑุงุฑ/ูุญุงฺฉูู',
		]),
		'space': _section(
			'๐ฐ๏ธ <b>ุขููุฒุด ูุถุง</b>', [
			'โข ูุงููุฑุชโูุง ู ูพฺููุดโูุง ูุถุง (ุฏุฑ ุญุงู ุชูุณุนู)',
			'โข ูุงุฒููุฏ ููุงูุฑ ู ุจูุฏุฌู ูุณุชูุฑ',
			'ฺุทูุฑ ุงุณุชูุงุฏู ฺฉูุฏ: ูพุณ ุงุฒ ุชููุช ุงูุชุตุงุฏ/ููุงูุฑ ูุงุฑุฏ ุงู ุญูุฒู ุดูุฏ',
		]
		) + _result([
			'ูพุฑุณุชฺ ู ูุฒุงุง ุชฺฉููููฺฺฉ ุจููุฏูุฏุช',
			'ูุฒููโุจุฑ ู ุฒูุงูโุจุฑุ ุจุงุฒฺฏุดุช ุณุฑูุงู ุจููุฏูุฏุช',
		]),
		'technology': _section(
			'๐ง <b>ุขููุฒุด ููุงูุฑ</b>', [
			'ููููุง ููู ุฏุงุฎู ููุงูุฑ:',
			'โข ยซููุงูุฑ ูุธุงูยป: ุจูุจูุฏ ุชูุงู ุฑุฒู/ุชููุฏ ุชุฌูุฒุงุช',
			'โข ยซููุงูุฑ ุณุงุฎุชโูุณุงุฒยป: ฺฉุงูุด ูุฒูู/ุฒูุงู ุณุงุฎุช ู ุจูุจูุฏ ุธุฑูุช ุชููุฏ',
			'',
			'ฺุทูุฑ ุงุณุชูุงุฏู ฺฉูุฏ:',
			'1) ูุงุฒ ุฑุงูุจุฑุฏ ุฑุง ุชุนู ฺฉูุฏ (ูุธุงู ุง ุตูุนุช)  2) ุณุทุญโุจูุฏ ุชุฏุฑุฌ',
			'3) ุงุซุฑ ููุงูุฑ ุฑุง ุฏุฑ ูุญุงุณุจุงุช ุชููุฏ/ูุฏุฑุช ูุญุงุธ ฺฉูุฏ',
		]
		) + _result([
			'ุงูุฒุงุด ุจูุฑูโูุฑ ุชููุฏ ู ูุฏุฑุช ูุธุงู',
			'ูุงุฒ ุจู ุณุฑูุงูโฺฏุฐุงุฑ ู ุฒูุงู ุชุญูู',
		]),
	}

	map_key = {
		'tut_country_status': 'country_status',
		'tut_strategy': 'strategy',
		'tut_diplomacy': 'diplomacy',
		'tut_trade': 'trade',
		'tut_population': 'population',
		'tut_space': 'space',
		'tut_technology': 'technology',
	}

	content = sections.get(map_key.get(key, ''), 'ุฏุฑ ุญุงู ุขูุงุฏูโุณุงุฒ...')
	keyboard = [[InlineKeyboardButton('๐ ุจุงุฒฺฏุดุช ุจู ุขููุฒุด', callback_data='tutorial_menu')]]
	await query.edit_message_text(content, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode='HTML')


